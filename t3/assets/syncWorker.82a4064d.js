var gt=Object.defineProperty;var yt=(k,U,O)=>U in k?gt(k,U,{enumerable:!0,configurable:!0,writable:!0,value:O}):k[U]=O;var A=(k,U,O)=>(yt(k,typeof U!="symbol"?U+"":U,O),O);(function(){"use strict";const k=Symbol("Comlink.proxy"),U=Symbol("Comlink.endpoint"),O=Symbol("Comlink.releaseProxy"),Y=Symbol("Comlink.thrown"),ue=e=>typeof e=="object"&&e!==null||typeof e=="function",Pe={canHandle:e=>ue(e)&&e[k],serialize(e){const{port1:t,port2:r}=new MessageChannel;return X(e,t),[r,[r]]},deserialize(e){return e.start(),Oe(e)}},ze={canHandle:e=>ue(e)&&Y in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},de=new Map([["proxy",Pe],["throw",ze]]);function X(e,t=self){t.addEventListener("message",function r(n){if(!n||!n.data)return;const{id:o,type:s,path:f}=Object.assign({path:[]},n.data),l=(n.data.argumentList||[]).map(B);let i;try{const c=f.slice(0,-1).reduce((d,y)=>d[y],e),u=f.reduce((d,y)=>d[y],e);switch(s){case"GET":i=u;break;case"SET":c[f.slice(-1)[0]]=B(n.data.value),i=!0;break;case"APPLY":i=u.apply(c,l);break;case"CONSTRUCT":{const d=new u(...l);i=Le(d)}break;case"ENDPOINT":{const{port1:d,port2:y}=new MessageChannel;X(e,y),i=ye(d,[d])}break;case"RELEASE":i=void 0;break;default:return}}catch(c){i={value:c,[Y]:0}}Promise.resolve(i).catch(c=>({value:c,[Y]:0})).then(c=>{const[u,d]=ee(c);t.postMessage(Object.assign(Object.assign({},u),{id:o}),d),s==="RELEASE"&&(t.removeEventListener("message",r),he(t))})}),t.start&&t.start()}function De(e){return e.constructor.name==="MessagePort"}function he(e){De(e)&&e.close()}function Oe(e,t){return Q(e,[],t)}function J(e){if(e)throw new Error("Proxy has been released and is not useable")}function Q(e,t=[],r=function(){}){let n=!1;const o=new Proxy(r,{get(s,f){if(J(n),f===O)return()=>F(e,{type:"RELEASE",path:t.map(l=>l.toString())}).then(()=>{he(e),n=!0});if(f==="then"){if(t.length===0)return{then:()=>o};const l=F(e,{type:"GET",path:t.map(i=>i.toString())}).then(B);return l.then.bind(l)}return Q(e,[...t,f])},set(s,f,l){J(n);const[i,c]=ee(l);return F(e,{type:"SET",path:[...t,f].map(u=>u.toString()),value:i},c).then(B)},apply(s,f,l){J(n);const i=t[t.length-1];if(i===U)return F(e,{type:"ENDPOINT"}).then(B);if(i==="bind")return Q(e,t.slice(0,-1));const[c,u]=_e(l);return F(e,{type:"APPLY",path:t.map(d=>d.toString()),argumentList:c},u).then(B)},construct(s,f){J(n);const[l,i]=_e(f);return F(e,{type:"CONSTRUCT",path:t.map(c=>c.toString()),argumentList:l},i).then(B)}});return o}function Be(e){return Array.prototype.concat.apply([],e)}function _e(e){const t=e.map(ee);return[t.map(r=>r[0]),Be(t.map(r=>r[1]))]}const ge=new WeakMap;function ye(e,t){return ge.set(e,t),e}function Le(e){return Object.assign(e,{[k]:!0})}function ee(e){for(const[t,r]of de)if(r.canHandle(e)){const[n,o]=r.serialize(e);return[{type:"HANDLER",name:t,value:n},o]}return[{type:"RAW",value:e},ge.get(e)||[]]}function B(e){switch(e.type){case"HANDLER":return de.get(e.name).deserialize(e.value);case"RAW":return e.value}}function F(e,t,r){return new Promise(n=>{const o=Fe();e.addEventListener("message",function s(f){!f.data||!f.data.id||f.data.id!==o||(e.removeEventListener("message",s),n(f.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),r)})}function Fe(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var b=Uint8Array,L=Uint16Array,we=Uint32Array,pe=new b([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),me=new b([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$e=new b([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xe=function(e,t){for(var r=new L(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var o=new we(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)o[s]=s-r[n]<<5|n;return[r,o]},ve=xe(pe,2),Ee=ve[0],je=ve[1];Ee[28]=258,je[258]=28;for(var Ve=xe(me,0),We=Ve[0],te=new L(32768),_=0;_<32768;++_){var T=(_&43690)>>>1|(_&21845)<<1;T=(T&52428)>>>2|(T&13107)<<2,T=(T&61680)>>>4|(T&3855)<<4,te[_]=((T&65280)>>>8|(T&255)<<8)>>>1}for(var W=function(e,t,r){for(var n=e.length,o=0,s=new L(t);o<n;++o)e[o]&&++s[e[o]-1];var f=new L(t);for(o=0;o<t;++o)f[o]=f[o-1]+s[o-1]<<1;var l;if(r){l=new L(1<<t);var i=15-t;for(o=0;o<n;++o)if(e[o])for(var c=o<<4|e[o],u=t-e[o],d=f[e[o]-1]++<<u,y=d|(1<<u)-1;d<=y;++d)l[te[d]>>>i]=c}else for(l=new L(n),o=0;o<n;++o)e[o]&&(l[o]=te[f[e[o]-1]++]>>>15-e[o]);return l},G=new b(288),_=0;_<144;++_)G[_]=8;for(var _=144;_<256;++_)G[_]=9;for(var _=256;_<280;++_)G[_]=7;for(var _=280;_<288;++_)G[_]=8;for(var be=new b(32),_=0;_<32;++_)be[_]=5;var Ge=W(G,9,1),He=W(be,5,1),re=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},S=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},ne=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Ze=function(e){return(e+7)/8|0},oe=function(e,t,r){(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length);var n=new(e.BYTES_PER_ELEMENT==2?L:e.BYTES_PER_ELEMENT==4?we:b)(r-t);return n.set(e.subarray(t,r)),n},qe=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],I=function(e,t,r){var n=new Error(t||qe[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,I),!r)throw n;return n},Je=function(e,t,r){var n=e.length;if(!n||r&&r.f&&!r.l)return t||new b(0);var o=!t||r,s=!r||r.i;r||(r={}),t||(t=new b(n*3));var f=function(Ue){var ke=t.length;if(Ue>ke){var Te=new b(Math.max(ke*2,Ue));Te.set(t),t=Te}},l=r.f||0,i=r.p||0,c=r.b||0,u=r.l,d=r.d,y=r.m,v=r.n,M=n*8;do{if(!u){l=S(e,i,1);var a=S(e,i+1,3);if(i+=3,a)if(a==1)u=Ge,d=He,y=9,v=5;else if(a==2){var h=S(e,i,31)+257,x=S(e,i+10,15)+4,$=h+S(e,i+5,31)+1;i+=14;for(var N=new b($),E=new b(19),p=0;p<x;++p)E[$e[p]]=S(e,i+p*3,7);i+=x*3;for(var j=re(E),H=(1<<j)-1,P=W(E,j,1),p=0;p<$;){var Z=P[S(e,i,H)];i+=Z&15;var w=Z>>>4;if(w<16)N[p++]=w;else{var K=0,z=0;for(w==16?(z=3+S(e,i,3),i+=2,K=N[p-1]):w==17?(z=3+S(e,i,7),i+=3):w==18&&(z=11+S(e,i,127),i+=7);z--;)N[p++]=K}}var Ce=N.subarray(0,h),D=N.subarray(h);y=re(Ce),v=re(D),u=W(Ce,y,1),d=W(D,v,1)}else I(1);else{var w=Ze(i)+4,m=e[w-4]|e[w-3]<<8,g=w+m;if(g>n){s&&I(0);break}o&&f(c+m),t.set(e.subarray(w,g),c),r.b=c+=m,r.p=i=g*8,r.f=l;continue}if(i>M){s&&I(0);break}}o&&f(c+131072);for(var ht=(1<<y)-1,_t=(1<<v)-1,le=i;;le=i){var K=u[ne(e,i)&ht],V=K>>>4;if(i+=K&15,i>M){s&&I(0);break}if(K||I(2),V<256)t[c++]=V;else if(V==256){le=i,u=null;break}else{var Ne=V-254;if(V>264){var p=V-257,q=pe[p];Ne=S(e,i,(1<<q)-1)+Ee[p],i+=q}var ce=d[ne(e,i)&_t],fe=ce>>>4;ce||I(3),i+=ce&15;var D=We[fe];if(fe>3){var q=me[fe];D+=ne(e,i)&(1<<q)-1,i+=q}if(i>M){s&&I(0);break}o&&f(c+131072);for(var Ke=c+Ne;c<Ke;c+=4)t[c]=t[c-D],t[c+1]=t[c+1-D],t[c+2]=t[c+2-D],t[c+3]=t[c+3-D];c=Ke}}r.l=u,r.p=le,r.b=c,r.f=l,u&&(l=1,r.m=y,r.d=d,r.n=v)}while(!l);return c==t.length?t:oe(t,0,c)},Ye=new b(0),C=function(e,t){return e[t]|e[t+1]<<8},R=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},se=function(e,t){return R(e,t)+R(e,t+4)*4294967296};function Xe(e,t){return Je(e,t)}var ie=typeof TextDecoder<"u"&&new TextDecoder,Qe=0;try{ie.decode(Ye,{stream:!0}),Qe=1}catch{}var et=function(e){for(var t="",r=0;;){var n=e[r++],o=(n>127)+(n>223)+(n>239);if(r+o>e.length)return[t,oe(e,r-1)];o?o==3?(n=((n&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):o&1?t+=String.fromCharCode((n&31)<<6|e[r++]&63):t+=String.fromCharCode((n&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(n)}};function Me(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}else{if(ie)return ie.decode(e);var o=et(e),s=o[0],f=o[1];return f.length&&I(8),s}}var tt=function(e,t){return t+30+C(e,t+26)+C(e,t+28)},rt=function(e,t,r){var n=C(e,t+28),o=Me(e.subarray(t+46,t+46+n),!(C(e,t+8)&2048)),s=t+46+n,f=R(e,t+20),l=r&&f==4294967295?nt(e,s):[f,R(e,t+24),R(e,t+42)],i=l[0],c=l[1],u=l[2];return[C(e,t+10),i,c,o,s+C(e,t+30)+C(e,t+32),u]},nt=function(e,t){for(;C(e,t)!=1;t+=4+C(e,t+2));return[se(e,t+12),se(e,t+4),se(e,t+20)]};function Ae(e,t){for(var r={},n=e.length-22;R(e,n)!=101010256;--n)(!n||e.length-n>65558)&&I(13);var o=C(e,n+8);if(!o)return{};var s=R(e,n+16),f=s==4294967295||o==65535;if(f){var l=R(e,n-12);f=R(e,l)==101075792,f&&(o=R(e,l+32),s=R(e,l+48))}for(var i=t&&t.filter,c=0;c<o;++c){var u=rt(e,s,f),d=u[0],y=u[1],v=u[2],M=u[3],a=u[4],w=u[5],m=tt(e,w);s=a,(!i||i({name:M,size:y,originalSize:v,compression:d}))&&(d?d==8?r[M]=Xe(e.subarray(m,m+y),new b(v)):I(14,"unknown compression type "+d):r[M]=oe(e,m,m+y))}return r}async function Se(e){const t=new FileReader;return new Promise((r,n)=>{t.onloadend=o=>{var s;o.target?r((s=o.target)==null?void 0:s.result):r(null)},t.onerror=n,t.readAsArrayBuffer(e)})}async function ot(e){const t=new FileReader;return new Promise((r,n)=>{t.onloadend=o=>{o.target?r(o.target.result):r(null)},t.onerror=n,t.readAsText(e)})}async function Ie(e,t){if(t){const r=await Se(e);if(r instanceof ArrayBuffer){const n=Ae(new Uint8Array(r)),o=Object.keys(n)[0];if(o){const s=Me(n[o]);if(s&&typeof s=="string")return JSON.parse(s)}}return null}else{const r=await ot(e);return r&&typeof r=="string"?JSON.parse(r):null}}class st{constructor(){A(this,"worldIndex");A(this,"worldLength");A(this,"currentWorld");A(this,"currentIdMapIndex");A(this,"worldIdMapKeys");A(this,"currentModel",null);A(this,"data")}async loadUrl(t){try{const n=await fetch("/temp/"+t),o=await Ie(await n.blob(),t.includes("zip"));this.initModel(o)}catch(r){console.log(t,r),this.initModel(null)}}initModel(t){var r;this.data=t,this.currentIdMapIndex=-1,this.worldIndex=-1,this.worldLength=((r=t==null?void 0:t.world)==null?void 0:r.length)|0,this.worldIdMapKeys=[]}loadNextModel(){return this.currentModel=this.loadNextModelInternal(),!!this.currentModel}loadNextModelInternal(){return this.data?this.currentWorld?(this.currentIdMapIndex<this.worldIdMapKeys.length-1&&this.currentIdMapIndex++,this.currentIdMapIndex>=0&&(this.currentModel=this.nextId()),this.currentIdMapIndex===this.worldIdMapKeys.length-1&&(this.currentWorld=null,this.worldIdMapKeys=[],this.currentIdMapIndex=-1),this.currentModel):(this.worldIndex++,this.worldIndex<this.worldLength?(this.currentWorld=this.data.world[this.worldIndex],this.worldIdMapKeys=Object.keys(this.currentWorld.id_map),this.currentModel=this.loadNextModelInternal(),this.currentModel):(this.currentModel=null,null)):null}transferModel(){if(!this.currentModel)return null;const t=this.currentModel;return this.currentModel=null,ye(t,[t.index.buffer,t.position.buffer,t.vertexColor.buffer])}nextId(){var a;const t=this.worldIdMapKeys[this.currentIdMapIndex],r=(a=this.currentWorld)==null?void 0:a.id_map[t],n=this.currentWorld;if(!r||!n)throw"error with idmap"+t+", "+this.currentIdMapIndex;const o=new Uint32Array(r.index),s=new Float32Array(r.position||[]),f=new Float32Array(r.vertexColor||[]),l=r.color||[0,0,0,1],i=r.matrix,c=r.instances,u=r.wireframeGeometry,d=r.id_sequence;let y=null;typeof r.position=="string"&&(y=r.position);let v=null;typeof r.index=="string"&&(v=r.index);let M=null;return typeof r.vertexColor=="string"&&(M=r.vertexColor),{IdMapString:t,wireframeGeometry:u,color:l,vertexColor:f,vertexColorRef:M,position:s,positionRef:y,matrix:i,instance:c,id_sequence:d,index:o,indexRef:v}}}async function it(){return{ENV_AZURE_CLIENT_ID:"d1a47ca2-bf8d-471d-9781-f1711981a922",ENV_AZURE_TENANT_ID:"306bb27f-a230-403b-a436-2e5cd45b8ec0",ENV_AZURE_LOGIN_URL:"https://login.microsoftonline.com",ENV_AZURE_STORAGE_URL:"https://stdataaibelweb3d001.blob.core.windows.net",ENV_AZURE_STORAGE_SHARE_CONTAINER_NAME:"set-share",ENV_AZURE_STORAGE_PROJECT_CONTAINER_NAME:"000000"}}async function Re(e,t,r){const n=await it();return await fetch(`${n.ENV_AZURE_STORAGE_URL}/${t}/${r}`,{headers:{"cache-control":"no-cache",pragma:"no-cache","x-ms-version":"2021-04-10","x-ms-date":new Date().toUTCString(),authorization:`Bearer ${e}`}})}async function at(e,t){const r=await Se(e);if(r instanceof ArrayBuffer){const n=Ae(new Uint8Array(r)),o=Object.keys(n)[0];if(o)return t==="uint32"?new Uint32Array(n[o].buffer):new Float32Array(n[o].buffer)}return null}async function ae(e,t,r,n){const o=await Re(e,t,r);return o.ok?await at(await o.blob(),n):(console.warn("error"),console.warn(r),null)}async function lt(e,t,r,n=!1){const o=await Re(e,t,r);if(o.ok)return Ie(await o.blob(),r.includes(".zip"));throw n||(console.warn("error"),console.warn(r)),o.statusText}function ct(e){return`META_${e}`}class ft{constructor(t,r=1,n="DATA"){A(this,"__name");A(this,"__version");A(this,"__storeName");A(this,"__logEnabled");A(this,"__db");this.__name=t,this.__version=r,this.__storeName=n,this.__logEnabled=!1}enableLog(){this.__logEnabled=!0}__logStart(t){this.__logEnabled&&console.time(`ModelStoreLog_${this.__name}_${this.__storeName}_${t}`)}__logEnd(t){this.__logEnabled&&console.timeEnd(`ModelStoreLog_${this.__name}_${this.__storeName}_${t}`)}close(){return new Promise(t=>{this.__db&&(this.__db.close(),t(!0))})}__open(){return new Promise((t,r)=>{if(this.__db)t(this.__db);else{const n=indexedDB.open(this.__name,this.__version);n.onupgradeneeded=()=>{const o=n.result;o.objectStoreNames.contains(this.__name)||o.createObjectStore(this.__storeName)},n.onblocked=o=>{this.__logEnd("getKey"),r({type:"onblocked",event:o})},n.onerror=o=>{this.__logEnd("getKey"),r({type:"onblocked",event:o})},n.onsuccess=()=>{this.__db=n.result,t(n.result)}}})}getUUID(){return crypto.randomUUID()}getKey(t){return new Promise(async(r,n)=>{this.__logStart("getKey");try{const s=(await this.__open()).transaction(this.__storeName);s.onerror=i=>{this.__logEnd("getKey"),n({type:"store tx error",event:i})};const l=s.objectStore(this.__storeName).get(t);l.onsuccess=()=>{this.__logEnd("getKey"),r(l.result)}}catch(o){this.__logEnd("getKey"),n(o)}})}setKey(t,r){return new Promise(async(n,o)=>{var s;this.__logStart("setKey");try{const l=(await this.__open()).transaction(this.__storeName,"readwrite");l.onerror=u=>{this.__logEnd("setKey"),o({type:"store tx error",event:u})};const c=l.objectStore(this.__storeName).put(r,t);c.onsuccess=()=>{this.__logEnd("setKey"),n(c.result)},(s=c.transaction)==null||s.commit()}catch(f){this.__logEnd("setKey"),o(f)}})}getAllKeys(){return new Promise(async(t,r)=>{this.__logStart("getAllKeys");try{const o=(await this.__open()).transaction(this.__storeName,"readwrite");o.onerror=l=>{this.__logEnd("getAllKeys"),r({type:"store tx error",event:l})};const f=o.objectStore(this.__storeName).getAllKeys();f.onsuccess=()=>{this.__logEnd("getAllKeys"),t(f.result)}}catch(n){this.__logEnd("getAllKeys"),r(n)}})}deleteKey(t){return new Promise(async(r,n)=>{this.__logStart("deleteKey");try{const s=(await this.__open()).transaction(this.__storeName,"readwrite");s.onerror=i=>{this.__logEnd("deleteKey"),n({type:"store tx error",event:i})};const l=s.objectStore(this.__storeName).delete(t);l.onsuccess=()=>{this.__logEnd("deleteKey"),r(l.result)}}catch(o){this.__logEnd("deleteKey"),n(o)}})}deleteDB(){return new Promise((t,r)=>{this.__logStart("deleteDB");const n=indexedDB.deleteDatabase(this.__name);n.onsuccess=()=>{this.__logEnd("deleteDB"),t(!0)},n.onerror=o=>{this.__logEnd("deleteDB"),r({type:"onblocked",event:o})}})}}function ut(e){const t={x:null,y:null,z:null},r={x:null,y:null,z:null};let n=0;for(;n<e.length;)for(let o=0;o<3;o++,n++){const s=e[n]||0;o===0&&(t.x===null&&(t.x=s),r.x===null&&(r.x=s),t.x<s&&(t.x=s),r.x>s&&(r.x=s)),o===1&&(t.y===null&&(t.y=s),r.y===null&&(r.y=s),t.y<s&&(t.y=s),r.y>s&&(r.y=s)),o===2&&(t.z===null&&(t.z=s),r.z===null&&(r.z=s),t.z<s&&(t.z=s),r.z>s&&(r.z=s))}return{X:t.x||0,Y:t.y||0,Z:t.z||0,x:r.x||0,y:r.y||0,z:r.z||0}}class dt{async downloadFromAzure(t,r,n,o,s){try{let f=function(a,w){const m=a.split("/").pop()||"";return a.replace(m,`data/${w.replaceAll("$$","%24%24")}.zip`)};const l=new ft(r),i=await lt(t,n,s),c=new st;c.initModel(i);const u=[],d=new Set,y={};for(;await c.loadNextModel();){const a=await c.currentModel;if(a){const w=[];if(a.indexRef){const g=f(s,a.indexRef),h=ae(t,n,g,"uint32").then(x=>{x&&(a.index=x.slice(32))});w.push(h)}if(a.positionRef){const g=f(s,a.positionRef),h=ae(t,n,g,"float32").then(x=>{x&&(a.position=x.slice(32))});w.push(h)}if(a.vertexColorRef){const g=f(s,a.vertexColorRef),h=ae(t,n,g,"float32").then(x=>{x&&(a.vertexColor=x.slice(32))});w.push(h)}await Promise.all(w);const m=!a.vertexColorRef;try{if(m){const g=[],h=[],x=new Map;let $=0;for(let N=0;N<a.index.length;N++){const E=a.index[N]*3,p=a.position[E],j=a.position[E+1],H=a.position[E+2],P=p.toString()+j.toString()+H.toString();x.has(P)?g.push(x.get(P)):(g.push($),x.set(P,$),$++,h.push(a.position[E]),h.push(a.position[E+1]),h.push(a.position[E+2]))}a.position=new Float32Array(h),a.index=new Uint32Array(g),a.id_sequence&&i.meta&&Object.keys(a.id_sequence).forEach(E=>{var Z;const p=[],[j,H]=a.id_sequence[E];for(let K=j;K<H+1;K++){const z=g[K]*3;p.push(h[z]),p.push(h[z+1]),p.push(h[z+2])}const P=(Z=i.meta[E])==null?void 0:Z[0];P&&(d.add(E),y[P]=ut(p))})}}catch{throw console.error("error in index/position/json",a.indexRef,a.positionRef,s),`error in index/position/json,
                                ${a.indexRef},
                                ${a.positionRef},
                                ${s}`}if(a.position.length){const g=a.position,h=l.getUUID();await l.setKey(h,g.buffer),a.position=h}else console.warn("missing position on",a),a.position=null;if(a.vertexColor.length){const g=a.vertexColor,h=l.getUUID();await l.setKey(h,g.buffer),a.vertexColor=h}else a.vertexColor=null;if(a.index.length){const g=a.index,h=l.getUUID();await l.setKey(h,g.buffer),a.index=h}else console.warn("missing index on",a),a.index=null;await l.setKey(a.IdMapString,a),u.push(a.IdMapString)}}let v=0,M=!0;for(;M&&i.meta;){const a=new Set;Object.keys(i.meta).forEach(m=>{const g=i.meta[m];a.add(g[1])});let w=0;Object.keys(i.meta).forEach(m=>{!a.has(m)&&!d.has(m)&&(w++,delete i.meta[m])}),w===0&&(M=!1),v=v+w}return await l.setKey(ct(o),{meta:i.meta,bbox:y}),await l.setKey(o,u),await l.close(),o}catch(f){console.error("error",o,f)}}}X(dt)})();
